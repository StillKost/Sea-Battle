<!DOCTYPE html>
<html>
<head>
	<title>Sea battle</title>
	<script type="text/javascript" src="jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="scripts.js"></script>
	<link rel="stylesheet" type="text/css" href="bootstrap-3.3.7-dist/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="styles.css">
	
</head>
<body>
<div class="row">
	<div class="container">
		<div class="col-md-6" id="user-user">
			<h3>User field</h3>
			<div class="field">

			</div>
		</div>
		<div class="col-md-6" id="user-cpu">
			<h3>CPU field</h3>
			<div class="field">

			</div>
		</div>
	</div>
		<div class="container">
		<div class="col-md-6" id="cpu-cpu">
			<h3>CPU field</h3>
			<div class="field">

			</div>
		</div>
		<div class="col-md-6" id="cpu-user">
			<h3>User field</h3>
			<div class="field">

			</div>
		</div>
	</div>
</div>
</body>
</html>
<script type="text/javascript">
	$(document).ready(function(){

		//буду тут накапливать попадания
		var myPoints = 0;
		var cpuPoints = 0;
		//куда цпу струлякал уже
		var shoted = ["-1,-1"];

		//поле игрока по квадратам
		var userSquares = $("#user-user").find(".square");

		var cpuUserSquares = $("#cpu-user").find(".square");
		var cpuSquares = $("#cpu-cpu").find(".square");
		var userCpuSquares = $("#user-cpu").find(".square");

		//матрицы 10х10
		var userField = TenToTen(userSquares, 10);
		var cpuField = TenToTen(cpuSquares, 10);

		var userCpuF = TenToTen(userCpuSquares, 10);
		var cpuUserSquaresF = TenToTen(cpuUserSquares, 10);

		$('#user-cpu .square').click(function (argument) {
			if($(this).hasClass('ship-hidden') && !$(this).hasClass('broke')){
				$(this).addClass('broke')
				var coords = $(this).attr('name').split('-');
				var x = parseFloat(coords[0]);
				var y = parseFloat(coords[1]);
				$(cpuField[x][y]).addClass('broke');
				myPoints++;
			}


			CheckWiner();
			Shot();
		});



		function Shot(){
			var squares = $("#user-user").find(".square");
			var matrix = TenToTen(squares, 10);
			var x = RandomInt(0,10);
			var y = RandomInt(0,10);
			//shoted.push(x + "," + y);

			for(var i = 0; i < shoted.length; i++){
				var arr = shoted[i].split(',');
				var _x = parseFloat(arr[0]);
				var _y = parseFloat(arr[1]);
				if(x == _x && y == _y){
					x = RandomInt(0,10);
					y = RandomInt(0,10);
				} else { 
					shoted.push(x + "," + y);
					break;
				}
			}		


			var elem = matrix[x][y];
			if($(elem).hasClass('ship') && !$(elem).hasClass('broke')){
				$(matrix[x][y]).addClass('broke');
				console.log('я попал');
				cpuPoints++;
			}
			CheckWiner();
		}


		function CheckWiner(){
			if(myPoints == 35){
				alert('Костя победил!');
				var shots = Unique(shoted);
				console.log(shots);
			}
			if(cpuPoints == 35){
				alert('Костя проиграл!');
				var shots = Unique(shoted);
				console.log(shots);
			}
		}

	})

	function Unique(arr) {
		var result = [];

		nextInput:
			for (var i = 0; i < arr.length; i++) {
				var str = arr[i]; // для каждого элемента
					for (var j = 0; j < result.length; j++) { // ищем, был ли он уже?
						if (result[j] == str) continue nextInput; // если да, то следующий
					}
				result.push(str);
			}

		return result.length;
	}



	function TenToTen(input, size){
	  for(var x, i = 0, c = -1, l = input.length, n = []; i < l; i++){  
	    (x = i % size) ? n[c][x] = input[i] : n[++c] = [input[i]];
	  }
	  return n;
	}

	function RandomInt(min, max) {
  		return Math.floor(Math.random() * (max - min)) + min;
	}
</script>>